# DDM前処理コード

## 倒産予測

データは3つ。IDWH?データから持ってきたもの

- CIDAS
  - 各企業ごとの財務データと「倒産、解散、非倒産」データ
  - LBC(ランドスケープデータ)とComの共通顧客ID (CID)を結合したもの
  - 前処理：nanを0にした事と、余分なcolumnを消した程度
- 名寄せ
  - Comの回線データ。
    - 国内電話回線
    - OCN回線
    - 法人回線
    - BizFax回線
  - CIDごとに契約開始日終了日が載っている。
  - 前処理：各回線の増減数を以下の期間ごとに算出
    - 3,6ヶ月
    - 1,3,5,10年
- BELUGA
  - BELUGA(請求システム)から取得した顧客への請求情報（Com?）
  - 前処理：請求額の増減率を算出
    - 3,6,12,24ヶ月



## 成長予測

企業の売り上げは契約回線数と高い相関が見られることから、企業の売り上げ増ではなく、回線増を予測する

（売り上げ増は売上データに偏りがあり、うまく予測できなかった。）

ここで呼ぶ回線とは以下

- 国内電話、コンシューマ向けOCN、法人サービス、BizFax、ビジネス向けOC N、ブロードバンドアクセス、専用サービス、Global Service(ALTAIR)、e-VLAN、C向けVoIP、IPVPN（IP伝送）、B向けVoIP、ギガウェイ、Global Service(GCM)、ArcstarグローバルデータNWサービス、ArcstarグローバルIP-VPNサービス、オープンCDN

  

データは2つ

- 名寄せ

  1. 年初め、月初め時点の契約回線数をまとめる。回線数の移動平均を算出

  2. - 1を元に以下の期間ごとに契約回線の増減数、増減率を算出3,6ヶ月,1,3,5,10年
     - n年後の回線数増減率でソート。Top50%を1、それ以外を0 (なぜtop50？)　n=2,3,5

  3. 2を全回線/国内電話/C-OCN/法人向け/BizFaxごとに算出



- BELUGA
  - CIDをもとに
  - 請求金額の12ヶ月移動平均、12ヶ月増減率を3,6,12ヶ月毎に算出
- （教師データ）
  - 回線数増減率Top50%の企業かを予測できるように名寄せを加工





t検定　補足
AとBの幸福度の平均値に有意差が出る条件
- 平均値の差が大きい
- 各平均値が信用できる（分散が小さい）
- サンプルサイズが大きい
これら3つをもとに有意度合いを数値化

 t ＝ 平均値の差）／sqrt（（Aの分散／Aの標本数）＋（Bの分散／Bの標本数））　＝　平均値の差　/ ノイズ

tが2を超えると平均値に有意差があると経験的に言われており、95%偶然ではないと言える。
残りの5%が100*p値。つまりp値が小さいほどその差は偶然ではなく、0.05を下回ると有意差があると言える。