# CID-D商品分類

## 概要

- Acc 40%
- よく利用される手法はほぼ試した

### 相談したいこと

テストデータの作り方はこれで良いか

このタスクのゴールはどこか



## データ分析結果

- 不均衡データ
- 小規模データ　6000サンプル（フィラー約2000含む）
- サンプルあたりの単語数
  - 平均単語長 12
  - 2単語からなるサンプルが最多 (ほとんどがフィラー　例. 「いらっしゃい　ませ」)
- 各商品ごとに特徴的な単語は存在する
  - tfidfの大きい単語を見てみた



## 分類

### 出力形式

- [x] ***21クラス分類***

- [ ] 商品に関する発話か否か***2値分類***→どの商品に関する発話か***19クラス分類***

- [ ] その商品の発話としてふさわしいか***2値分類*19クラス。閾値を超える商品がなければフィラーと断定

### データの作成　（train : test = 3797 : 2435）

- [x] 明らかにインサイトが含まれない発話の削除
- [x] 学習データに含まれない応対（documentID）の発話についてテスト
- [x] 全てのクラスについてテスト
  - [x] 学習データに含まれないクラスもテスト(Picxel 4a)
  - [x] 検証データは用意しない

### 前処理

- [ ] クリーニング

- [x] 単語分割

  mecab

- [x] 正規化

  - [x] 動詞は原形に置換

- [x] 自作ストップワードの除去

- [x] 特定の品詞以外の除去

- [ ] 低頻度語の除去

- [x] データ拡張

  - [x] ランダム（確率pで）
    - [ ] 同義語を入れ替え（WordNet）
    - [ ] 同義語を挿入
    - [ ] 単語を移動
    - [x] 単語を削除
  - [x] アップサンプリング
    - [x] 閾値でm倍

### 文脈の考慮

- [x] (n文字)　対象発話　（n文字）
  - [ ] まとめて特徴抽出（語順考慮の場合は"@@"で区切る）
  - [x] 3つのまとまりそれぞれをencodingしたのちにconcat
- [ ] (n発話)　対象発話　（n発話）

### 特徴抽出器

- [x] BOW
  - [ ] SVD
- [ ] TFIDF
  - [ ] SVD
- [ ] fastTextの平均
- [ ] fastTextのmaxpooling

### 分類器

- [ ] SVM
- [ ] RF
- [x] LightGBM
- [ ] ロジスティック回帰
- [ ] CNN

```
                            precision    recall  f1-score   support

                 Ai Glass       0.62      1.00      0.77        20
                Bocco emo       0.28      0.83      0.42        12
Chromecast with Google TV       0.85      0.35      0.49       344
               Clear Keep       0.45      0.72      0.55        18
                 Gate Box       0.86      0.36      0.51       242
                  Mono X7       0.24      0.90      0.38        10
               Nest Audio       1.00      0.06      0.12        31
                Nest Hub        0.43      0.04      0.07        76
             Nest Hub MAX       0.04      0.62      0.08        16
                Nest Mini       0.49      0.27      0.34       158
                Nest Wifi       0.00      0.00      0.00        10
                     Null       0.25      0.73      0.38       237
                    OTHER       0.14      0.01      0.02       159
                    Pixel       0.00      0.00      0.00         4
                 Pixel 4a       0.00      0.00      0.00        14
             Pixel 4a（5G）       0.86      0.14      0.24        44
                  Pixel 5       0.59      0.58      0.59       115
                 ZEN DURE       0.00      0.00      0.00         3
                      mui       0.66      0.56      0.60       180
                  toletta       0.76      0.82      0.79        55
            スマホUV紫外線除菌ケース       0.17      1.00      0.29         1

              avg / total       0.58      0.41      0.41      1749

Accuracy is 0.4065180102915952 

```

## 今後の検討項目

- [ ] 使う品詞や活用系を工夫する

- [ ] データ拡張のバリエーションを増やす

- [x] もっと良いfastTextを使う

  - [ ] 現在のは語彙サイズが小さく、半分程度の単語をunkにしている

- [ ] CNNへの入力形式を工夫する

  実装がまだ中途半端

- [ ] 発話時間を使う

  同じ応対内でも発話間に時間経過があって話題が変わる箇所が散見される。

- [ ] 追加であると精度向上につながるデータを検討する

  - [ ] 辞書
  - [ ] 話者情報（店員？お客？）



クラスの絞り込み

類似クラスをまとめる

フィラーの削除

Null とotherの統合



ストップワードリスト

sns-analysis/AnalysisServer/backend/rules_for_normalize/stopwords.txt













